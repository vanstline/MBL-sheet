<!DOCTYPE html>
<html>
  <head lang="zh">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="renderer" content="webkit" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1,user-scalable=0" />
    <title>MBLsheet</title>

    <link rel="stylesheet" href="./plugins/css/pluginsCss.css" />
    <link rel="stylesheet" href="./plugins/plugins.css" />
    <link rel="stylesheet" href="./css/MBLsheet.css" />
    <link rel="stylesheet" href="./assets/iconfont/iconfont.css" />
    <script src="./plugins/js/plugin.js"></script>

    <!-- rollup MBLsheet.js -->
    <script src="./MBLsheet.umd.js"></script>
  </head>

  <body>
    <!-- Non-full screen test -->
    <div style="margin: 80px auto; padding: 0px; width: 970px">
      <div>
        è¡Œæ•°ï¼š<input type="text" id="row" value="100" /><button
          id="setRow"
          onclick="MBLsheet.setRow($('#row').val())">
          è®¾ç½®
        </button>
      </div>
      <div style="position: relative; width: 970px; height: 500px">
        <div id="mblsheet" style="width: 970px; height: 500px"></div>

        <!-- <div style="margin: 30px auto; display: flex; justify-content: center">
        <canvas
          id="ctx"
          width="300"
          height="300"
          style="border: 1px solid #000" />
      </div> -->
      </div>
      <div>
        <input
          type="button"
          value="è·å–æ•°æ®"
          onclick="console.log(MBLsheet.getData())" />
        <input
          type="button"
          value="è·å–æ•°æ®ï¼Œå¹¶æ ¡éªŒ"
          onclick="console.log(MBLsheet.getData(true))" />
      </div>
    </div>

    <!-- full screen test -->
    <!-- <div
      id="MBLsheet"
      style="
        margin: 0px;
        padding: 0px;
        position: absolute;
        width: 100%;
        height: 100%;
        left: 0px;
        top: 0px;
      "></div> -->
    <!-- demo feature, non-production use -->
    <script src="./demoData/demoFeature.js"></script>

    <script src="./demoData/sheetFormula.js"></script>
    <script src="./demoData/sheetCell.js"></script>
    <script src="./demoData/sheetConditionFormat.js"></script>
    <script src="./demoData/sheetTable.js"></script>
    <script src="./demoData/sheetComment.js"></script>
    <script src="./demoData/sheetPivotTableData.js"></script>
    <script src="./demoData/sheetPivotTable.js"></script>
    <script src="./demoData/sheetSparkline.js"></script>
    <script src="./demoData/sheetChart.js"></script>
    <script src="./demoData/sheetPicture.js"></script>
    <script src="./demoData/sheetDataVerification.js"></script>

    <script src="./demoData/demoSg.js"></script>

    <script>
      const excelDataSource = [
        {
          createDate: "2024-03-25 19:44:36.0",

          cxPrimerCartId: 1731287,

          cxPrimerCartInfo: [
            {
              baseNumber: 0,

              concentration: "",

              createDate: "2024-03-25 19:44:36.0",

              cxPrimerCode: "U1011200",

              cxPrimerId: 2250,

              endDate: null,

              id: 1731287,

              ids: null,

              isOldPrimer: 1,

              mark: null,

              name: "ITS3",

              page: 1,

              primerTypeIds: null,

              reverseSequence: "",

              rows: 20,

              sequence: "GCATCGATGAAGAACGCAGC",

              startDate: null,

              status: 0,

              targetLength: 0,

              type: 1,

              typeName: "é€šç”¨",

              updateMark: null,

              userId: 375760,

              userInfo: null,
            },
          ],

          cxPrimerCartList: [],

          cxSampleCartId: 8684104,

          cxSampleCartInfo: [
            {
              carrierId: 0,

              carrierName: "1212",

              createDate: "2024-03-25 19:44:36.0",

              cxSampleCode: "31224032500002",

              cxSampleId: 32208228,

              endDate: null,

              id: 8684104,

              ids: null,

              isOldSample: 1,

              mark: null,

              maxFragmentLength: "23",

              minFragmentLength: "12",

              name: "qwer",

              note: "",

              page: 1,

              resistance: "12",

              rows: 20,

              sampleSequence: "",

              sampleTypeId: 1,

              sampleTypeIds: null,

              sampleTypeName: "PCRäº§ç‰©(å·²çº¯åŒ–)",

              startDate: null,

              status: 0,

              updateMark: null,

              userId: 375760,

              userInfo: null,
            },
          ],

          endDate: null,

          id: 22955773,

          ids: null,

          mark: null,

          page: 1,

          rows: 20,

          seqMark: "å™¬èŒä½“è´¨ç²’",

          seqText: "å•å‘",

          sequenceMethod: 0,

          sequenceQuest: 1,

          sort: 1,

          startDate: null,

          status: 0,

          updateMark: null,

          userId: 375760,

          userInfo: null,
        },

        {
          createDate: "2024-03-25 19:44:36.0",

          cxPrimerCartId: 1731287,

          cxPrimerCartInfo: [
            {
              baseNumber: 0,

              concentration: "",

              createDate: "2024-03-25 19:44:36.0",

              cxPrimerCode: "U1011200",

              cxPrimerId: 2250,

              endDate: null,

              id: 1731287,

              ids: null,

              isOldPrimer: 1,

              mark: null,

              name: "ITS3",

              page: 1,

              primerTypeIds: null,

              reverseSequence: "",

              rows: 20,

              sequence: "GCATCGATGAAGAACGCAGC",

              startDate: null,

              status: 0,

              targetLength: 0,

              type: 1,

              typeName: "é€šç”¨",

              updateMark: null,

              userId: 375760,

              userInfo: null,
            },
          ],

          cxPrimerCartList: [],

          cxSampleCartId: 8684105,

          cxSampleCartInfo: [
            {
              carrierId: 0,

              carrierName: "123",

              createDate: "2024-03-25 19:44:36.0",

              cxSampleCode: "31224032500001",

              cxSampleId: 32208227,

              endDate: null,

              id: 8684105,

              ids: null,

              isOldSample: 1,

              mark: null,

              maxFragmentLength: "34",

              minFragmentLength: "12",

              name: "12312312",

              note: "",

              page: 1,

              resistance: "123",

              rows: 20,

              sampleSequence: "",

              sampleTypeId: 1,

              sampleTypeIds: null,

              sampleTypeName: "PCRäº§ç‰©(å·²çº¯åŒ–)",

              startDate: null,

              status: 0,

              updateMark: null,

              userId: 375760,

              userInfo: null,
            },
          ],

          endDate: null,

          id: 22955774,

          ids: null,

          mark: null,

          page: 1,

          rows: 20,

          seqMark: "",

          seqText: "å•å‘",

          sequenceMethod: 0,

          sequenceQuest: 1,

          sort: 2,

          startDate: null,

          status: 0,

          updateMark: null,

          userId: 375760,

          userInfo: null,
        },
      ];

      const columns = [
        {
          dataIndex: "sampleName",

          title: "æ ·æœ¬åç§°",

          fieldsProps: {
            type: "text",

            compareInfo: {
              sign: "in", // æ¯”è¾ƒç¬¦

              range: [1, 10],
            },
          },

          render: (text, record, index) => {
            console.log(
              "%c Line:413 ğŸ¥‘ excelDataSource",
              "color:#4fff4B",
              text,
              record,
              index
            );
            return record.cxSampleCartInfo?.[0]?.name;
          },
        },

        {
          dataIndex: "sampleTypeName",

          title: "æ ·æœ¬ç±»å‹",

          fieldsProps: {
            type: "select",
            type2: "multi",
            defaultValue: "èŒæ ª",

            options: [
              "PCRå·²çº¯åŒ–",
              "PCRæœªçº¯åŒ–",
              "èŒæ ª",
              "è´¨ç²’",
              "PCRå·²çº¯åŒ–1",
              "PCRæœªçº¯åŒ–1",
              "èŒæ ª1",
              "è´¨ç²’1",
              "PCRå·²çº¯åŒ–2",
              "PCRæœªçº¯åŒ–2",
              "èŒæ ª2",
              "è´¨ç²’2",
              "PCRå·²çº¯åŒ–3",
              "PCRæœªçº¯åŒ–3",
              "èŒæ ª3",
              "è´¨ç²’3",
              "PCRå·²çº¯åŒ–4",
              "PCRæœªçº¯åŒ–4",
              "èŒæ ª4",
              "è´¨ç²’4",
              "PCRå·²çº¯åŒ–5",
              "PCRæœªçº¯åŒ–5",
              "èŒæ ª5",
              "è´¨ç²’5",
              "PCRå·²çº¯åŒ–6",
              "PCRæœªçº¯åŒ–6",
              "èŒæ ª6",
              "è´¨ç²’6",
            ],
          },

          render: (text, record, index) => {
            return record.cxSampleCartInfo?.[0]?.sampleTypeName;
          },
        },

        {
          dataIndex: "resistance",

          title: "æŠ—æ€§",

          fieldsProps: {
            type: "autocomplete",
            type2: "multi",
            // type: "select",
            // type2: "select",

            options: ["Kan", "Amp"],
          },

          render: (text, record, index) => {
            return record.cxSampleCartInfo?.[0]?.resistance;
          },
        },

        {
          dataIndex: "carrierName",

          title: "è½½ä½“",

          render: (text, record, index) => {
            return record.cxSampleCartInfo?.[0]?.carrierName;
          },
        },

        {
          dataIndex: "minFragmentLength",

          title: "æœ€å°é•¿åº¦",

          fieldsProps: {
            type: "text",

            compareInfo: {
              sign: "in", // æ¯”è¾ƒç¬¦

              range: [0, 999999],
            },
          },

          render: (text, record, index) => {
            return record.cxSampleCartInfo?.[0]?.minFragmentLength;
          },
        },

        {
          dataIndex: "maxFragmentLength",

          title: "æœ€å¤§é•¿åº¦",

          fieldsProps: {
            type: "text",

            compareInfo: {
              sign: "in", // æ¯”è¾ƒç¬¦

              range: [0, 999999],
            },
          },

          render: (text, record, index) => {
            return record.cxSampleCartInfo?.[0]?.maxFragmentLength;
          },
        },

        // {
        //   dataIndex: "sampleConcentration",

        //   title: "æ ·å“å¤‡æ³¨",

        //   fieldsProps: {
        //     type: "select",

        //     options: [
        //       "GC Rich",
        //       "å¤æ‚ç»“æ„",
        //       "é‡å¤åºåˆ—",
        //       "ä½æ‹·è´",
        //       "ç—…æ¯’DNA",
        //       "å™¬èŒä½“è´¨ç²’",
        //     ],
        //   },
        // },

        // {
        //   dataIndex: "sampleConcentration",

        //   title: "è¦æ±‚",

        //   fieldsProps: {
        //     type: "select",

        //     options: ["å•å‘", "æµ‹é€š", "åŒå‘", "å¤šå‘"],
        //   },

        //   render: (text, record, index) => {
        //     return record.seqText;
        //   },
        // },

        // {
        //   dataIndex: "primerTypeName",

        //   title: "å¼•ç‰©ç±»å‹",

        //   fieldsProps: {
        //     type: "select",

        //     options: ["é€šç”¨", "è‡ªå¸¦", "åˆæˆ", "æš‚å­˜å¼•ç‰©"],
        //   },

        //   render: (text, record, index) => {
        //     return record.cxPrimerCartInfo?.[0]?.typeName;
        //   },
        // },

        // {
        //   dataIndex: "primerName",

        //   title: "å¼•ç‰©åç§°",

        //   // render: (text, record, index) => {
        //   //   return record.cxPrimerCartInfo?.[0]?.name;
        //   // },
        // },

        {
          dataIndex: "options",
          title: "æ“ä½œ",
          fieldsProps: {
            defaultValue: "èŒæ ª",

            verifyFn(text) {
              return {
                status: true,
                message: text,
              };
            },
          },
          onchange: (text, record, { setRowData }) => {
            setRowData({ resistance: text * 2, sampleTypeName: text });
          },
          extra: {
            style: {
              width: 100,
              height: 50,
              background: "red",
            },
          },
        },
      ];

      $(function () {
        MBLsheet.init(
          { container: "mblsheet" },
          {
            columns: columns,
            dataSource: excelDataSource,
            row: 2,
          }
        );

        // setTimeout(() => {
        //   MBLsheet.destroy();
        //   MBLsheet.init(
        //     { container: "mblsheet" },
        //     {
        //       columns: columns,
        //       dataSource: excelDataSource,
        //       row: 20,
        //     }
        //   );
        // }, 5000);

        // const ranges = MBLsheet.getRange();
        // console.log("%c Line:132 ğŸ¥ ranges", "color:#e41a6a", ranges);
        // MBLsheet.create({
        //   container: "mblsheet",
        //   lang: "zh",
        //   data: [sgCell],
        // });
      });
    </script>
    <style>
      /* è‡ªå®šä¹‰loadingæ¼”ç¤ºæ ·å¼ */
      @keyframes loading-rotate {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes loading-dash {
        0% {
          stroke-dasharray: 1, 200;
          stroke-dashoffset: 0;
        }

        50% {
          stroke-dasharray: 90, 150;
          stroke-dashoffset: -40px;
        }

        100% {
          stroke-dasharray: 90, 150;
          stroke-dashoffset: -120px;
        }
      }

      .loadingAnimation {
        width: 3em;
        height: 3em;
        animation: loading-rotate 2s linear infinite;
      }

      .loadingAnimation circle {
        animation: loading-dash 1.5s ease-in-out infinite;
        stroke-dasharray: 90, 150;
        stroke-dashoffset: 0;
        stroke-width: 2;
        stroke: currentColor;
        stroke-linecap: round;
      }
    </style>

    <!-- <script>
      const cvs = document.getElementById("ctx");
      const ctx = cvs.getContext("2d");

      ctx.beginPath();

      // å·¦ä¸Šèµ·ç‚¹
      ctx.moveTo(50, 100);
      // å³ä¸Š å‘å³ç§»åŠ¨
      ctx.lineTo(100, 100);
      // å³ä¸‹ å‘ä¸‹ç§»åŠ¨
      ctx.lineTo(100, 150);
      // å·¦ä¸‹ å‘å·¦ç§»åŠ¨
      ctx.lineTo(50, 150);
      // å·¦ä¸Š å›åˆ°èµ·ç‚¹
      ctx.lineTo(50, 100);
      ctx.fillStyle = "#FC6666";
      ctx.fill();
      ctx.closePath();
    </script> -->
  </body>
</html>
