<!DOCTYPE html>
<html>
  <head lang="zh">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="renderer" content="webkit" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1,user-scalable=0" />
    <title>MBLsheet</title>

    <link rel="stylesheet" href="./plugins/css/pluginsCss.css" />
    <link rel="stylesheet" href="./plugins/plugins.css" />
    <link rel="stylesheet" href="./css/MBLsheet.css" />
    <link rel="stylesheet" href="./assets/iconfont/iconfont.css" />
    <script src="./plugins/js/plugin.js"></script>

    <!-- rollup MBLsheet.js -->
    <script src="./MBLsheet.umd.js"></script>
  </head>

  <body>
    <!-- Non-full screen test -->
    <div style="margin: 80px auto; padding: 0px; width: 970px">
      <div>
        Ë°åÊï∞Ôºö<input type="text" id="row" value="100" /><button
          id="setRow"
          onclick="MBLsheet.setRow($('#row').val())">
          ËÆæÁΩÆ
        </button>
      </div>
      <div style="position: relative; width: 100%; height: 100%">
        <div id="mblsheet" style="height: 500px"></div>
        <div>
          <input
            type="button"
            value="Ëé∑ÂèñÊï∞ÊçÆ"
            onclick="console.log(MBLsheet.getData())" />
          <input
            type="button"
            value="Ëé∑ÂèñÊï∞ÊçÆÔºåÂπ∂Ê†°È™å"
            onclick="console.log(MBLsheet.getData(true))" />
        </div>

        <!-- <div style="margin: 30px auto; display: flex; justify-content: center">
        <canvas
          id="ctx"
          width="300"
          height="300"
          style="border: 1px solid #000" />
      </div> -->
      </div>
    </div>

    <!-- full screen test -->
    <!-- <div
      id="MBLsheet"
      style="
        margin: 0px;
        padding: 0px;
        position: absolute;
        width: 100%;
        height: 100%;
        left: 0px;
        top: 0px;
      "></div> -->
    <!-- demo feature, non-production use -->
    <script src="./demoData/demoFeature.js"></script>

    <script src="./demoData/sheetFormula.js"></script>
    <script src="./demoData/sheetCell.js"></script>
    <script src="./demoData/sheetConditionFormat.js"></script>
    <script src="./demoData/sheetTable.js"></script>
    <script src="./demoData/sheetComment.js"></script>
    <script src="./demoData/sheetPivotTableData.js"></script>
    <script src="./demoData/sheetPivotTable.js"></script>
    <script src="./demoData/sheetSparkline.js"></script>
    <script src="./demoData/sheetChart.js"></script>
    <script src="./demoData/sheetPicture.js"></script>
    <script src="./demoData/sheetDataVerification.js"></script>

    <script src="./demoData/demoSg.js"></script>

    <script>
      $(function () {
        MBLsheet.init(
          { container: "mblsheet" },
          {
            columns: [
              // {
              //   dataIndex: "sampleId",
              //   title: "Ê†∑Êú¨ÁºñÂè∑",
              //   render: (text, record, index) => {
              //     return text + 10000;
              //   },
              //   onchange: (value, cell) => {
              //     const { r, c } = cell;
              //     console.log(
              //       "%c Line:92 üçé",
              //       " ÂΩìÂâçÊòØÁ¨¨",
              //       r,
              //       "Ë°åÔºåÁ¨¨",
              //       c,
              //       "ÂàóÔºåÂÄº‰∏∫'",
              //       value,
              //       "'"
              //     );
              //   },
              // },
              // {
              //   dataIndex: "sampleName",
              //   title: "Ê†∑Êú¨ÂêçÁß∞",
              //   fieldsProps: {
              //     type: "text",
              //     compareInfo: {
              //       sign: "in", // ÊØîËæÉÁ¨¶
              //       range: [1, 10],
              //     },
              //   },
              // },
              // {
              //   dataIndex: "sampleType",
              //   title: "Ê†∑Êú¨Á±ªÂûã",
              //   fieldsProps: {
              //     type: "select",
              //     options: ["1", "2", "3", "4", "5"],
              //   },
              // },
              // {
              //   dataIndex: "sampleCount",
              //   title: "Ê†∑Êú¨Êï∞Èáè",
              //   fieldsProps: {
              //     type: "textarea",
              //     compareInfo: {
              //       sign: "include", // ÊØîËæÉÁ¨¶
              //       value: "1",
              //     },
              //   },
              // },
              // {
              //   dataIndex: "sampleConcentration",
              //   title: "Ê†∑Êú¨ÊµìÂ∫¶",
              // },
              // {
              //   dataIndex: "sampleVolume",
              //   title: "Ê†∑Êú¨‰ΩìÁßØ",
              // },
              {
                title: "Êìç‰Ωú",
                render: (text, record, index) => {
                  const aHref = document.createElement("a");
                  aHref.href = "javascript:;";
                  aHref.innerText = "Âà†Èô§";
                  return aHref;
                },
                onchange: (value, cell) => {
                  console.log(
                    "%c Line:157 üéÇ value, cell",
                    "color:#93c0a4",
                    value,
                    cell
                  );
                },
              },
            ],
            dataSource: [
              {
                sampleId: "888",
                sampleName: "2222",
                sampleType: "1",
                sampleCount: "4444",
                sampleConcentration: "5555",
                sampleVolume: "6666",
              },
              // {
              //   sampleId: "1111",
              // },
            ],
            row: 2,
          }
        );

        // const ranges = MBLsheet.getRange();
        // console.log("%c Line:132 ü•ù ranges", "color:#e41a6a", ranges);
        // MBLsheet.create({
        //   container: "mblsheet",
        //   lang: "zh",
        //   data: [sgCell],
        // });
      });
    </script>
    <style>
      /* Ëá™ÂÆö‰πâloadingÊºîÁ§∫Ê†∑Âºè */
      @keyframes loading-rotate {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes loading-dash {
        0% {
          stroke-dasharray: 1, 200;
          stroke-dashoffset: 0;
        }

        50% {
          stroke-dasharray: 90, 150;
          stroke-dashoffset: -40px;
        }

        100% {
          stroke-dasharray: 90, 150;
          stroke-dashoffset: -120px;
        }
      }

      .loadingAnimation {
        width: 3em;
        height: 3em;
        animation: loading-rotate 2s linear infinite;
      }

      .loadingAnimation circle {
        animation: loading-dash 1.5s ease-in-out infinite;
        stroke-dasharray: 90, 150;
        stroke-dashoffset: 0;
        stroke-width: 2;
        stroke: currentColor;
        stroke-linecap: round;
      }
    </style>

    <!-- <script>
      const cvs = document.getElementById("ctx");
      const ctx = cvs.getContext("2d");

      ctx.beginPath();

      // Â∑¶‰∏äËµ∑ÁÇπ
      ctx.moveTo(50, 100);
      // Âè≥‰∏ä ÂêëÂè≥ÁßªÂä®
      ctx.lineTo(100, 100);
      // Âè≥‰∏ã Âêë‰∏ãÁßªÂä®
      ctx.lineTo(100, 150);
      // Â∑¶‰∏ã ÂêëÂ∑¶ÁßªÂä®
      ctx.lineTo(50, 150);
      // Â∑¶‰∏ä ÂõûÂà∞Ëµ∑ÁÇπ
      ctx.lineTo(50, 100);
      ctx.fillStyle = "#FC6666";
      ctx.fill();
      ctx.closePath();
    </script> -->
  </body>
</html>
